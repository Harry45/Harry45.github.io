<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Sampling From Any Distribution</title>
  <meta name="description" content="One of the recent topics which I had to study was how to sample from any distribution. While this seems to be a trivial question, Google did not help me much...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="http://localhost:4000/blog/2016/10/Sampling-From-Any-Distribution">
  <link rel="alternate" type="application/rss+xml" title="Arrykrishna Mootoovaloo" href="http://localhost:4000/feed.xml" />
<link rel='stylesheet' id='open-sans-css'  href='//fonts.googleapis.com/css?family=Open+Sans%3A300italic%2C400italic%2C600italic%2C300%2C400%2C600&#038;subset=latin%2Clatin-ext&#038;ver=4.2.4' type='text/css' media='all' />
<link href='//fonts.googleapis.com/css?family=Titillium+Web:600italic,600,400,400italic' rel='stylesheet' type='text/css'>




</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/">Arrykrishna Mootoovaloo</a>


    <nav class="site-nav">

      <a href="#" class="menu-icon menu.open">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>  

    <div class="trigger"><h1>Main Navigation</h1>

 <ul class="menu">

    
    
     <li><a href="/about/" class="page-link">About</a>
    
    </li>
    
    
     <li><a href="/blog/" class="page-link">Blog</a>
    
    </li>
    
    
    <li><a href="/teaching/" class="page-link">Teaching</a>
    <ul class="sub-menu">
    
    <li><a href="/teaching/A-Level-Mathematics/">A-Level Mathematics (9709)</a></li>
    
    <li><a href="/teaching/A-Level-Further-Mathematics/">A-Level Further Mathematics (9231)</a></li>
    
    <li><a href="/teaching/A-Level-Physics/">A-Level Physics (9702)</a></li>
    
    </ul>
    
    </li>
    
    
     <li><a href="/publications/" class="page-link">Publications</a>
    
    </li>
    
    
     <li><a href="/papers/" class="page-link">Papers</a>
    
    </li>
    
    
     <li><a href="/books/" class="page-link">Books</a>
    
    </li>
    
    
     <li><a href="/luminary/" class="page-link">Luminary</a>
    
    </li>
    
    
    <li><a href="/travel/" class="page-link">Travel</a>
    <ul class="sub-menu">
    
    <li><a href="/travel/Africa/">Africa</a></li>
    
    <li><a href="/travel/Europe/">Europe</a></li>
    
    </ul>
    
    </li>
    
    </ul>


<!-- <ul class="menu">
        <li> <a class="page-link" href="/about">About</a></li>
        <li> <a class="page-link"  href="/blog">Blog</a>
        <li> <a class="page-link" href="/blog">CV</a>
        <li> <a class="page-link" href="/blog">For Students</a></li>
        <li> <a class="page-link"  href="/blog">Research</a></a>
        <li> <a class="page-link" href="/blog">Teaching</a>
<ul class="sub-menu">
	<li><a href="http://svmiller.com/teaching/posc-1020-introduction-to-international-relations/">POSC 1020 – Introduction to International Relations</a></li>
	<li><a href="http://svmiller.com/teaching/posc-3410-quantitative-methods-in-political-science/">POSC 3410 – Quantitative Methods in Political Science</a></li>
	<li><a href="http://svmiller.com/teaching/posc-3610-international-politics-in-crisis/">POSC 3610 – International Politics in Crisis</a></li>
	<li><a href="http://svmiller.com/teaching/posc-3630-united-states-foreign-policy/">POSC 3630 – United States Foreign Policy</a></li>
</ul></li>
        <li> <a class="page-link" href="/blog">Miscellany</a>
<ul class="sub-menu">
	<li><a href="http://svmiller.com/teaching/posc-1020-introduction-to-international-relations/">Clean USAID Greenbook Data</a></li>
	<li><a href="http://svmiller.com/teaching/posc-3410-quantitative-methods-in-political-science/">Journal of Peace Research *.bst File</a></li>
	<li><a href="http://svmiller.com/teaching/posc-3610-international-politics-in-crisis/">My Custom Beamer Style</a></li>
</ul> 

</li>
</ul> -->

     </div>  
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="post">

  <header class="post-header">
    <h1 class="post-title">Sampling From Any Distribution</h1>
    <p class="post-meta">Posted on October 28, 2016 by  A.Mootoovaloo  

  in
  
  <a href="/categories/#Machine Learning and Statistics" title="Machine Learning and Statistics">Machine Learning and Statistics</a>&nbsp;
  


</p>
  </header>

  <head>
    <title>Font Awesome Icons</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  </head>
  
  <article class="post-content">
    <p align="justify">One of the recent topics which I had to study was how to sample from any distribution. While this seems to be a trivial question, Google did not help me much, although I did also try to post the problem on <a href="http://stackoverflow.com/questions/40263486/drawing-random-samples-from-any-distribution">stackoverflow</a>! Here, we will show three methods which we can use to generate random numbers from a distribution. In particular, we will look at some in-built functions in <code>scipy</code>, acceptance-rejection sampling and will consider interpolation method as well. The distribution which we will use is given by </p>

<p>\begin{align}
\mathcal{P}\left(x\right) = \dfrac{k\,x^3}{e^{2x} - 0.1}
\end{align}</p>

<p align="justify">where $k$ is the normalisation constant. Note that we will use the following notations: $\mathcal{P}\left(\centerdot\right)$ is the probability distribution function (PDF) while $\Phi\left(\centerdot\right)$ is the cumulative distribution function (CDF). The generic shape of this distribution follows that of a black body spectrum. This distribution is used only to illustrate the idea of sampling and we do not provide any relevant explanation to the actual physics of black body radiation in this post.</p>

<h2>Using Scipy</h2>

<p align="justify">The class <code>rv_continuous</code> in <code>scipy.stats</code> is straightforward to use. We simply need to define either the PDF or CDF using <code>_pdf</code> and <code>_cdf</code> respectively as shown below. We first define the PDF, followed by a function to normalise it. Note also that the PDF that we define in the class should be normalised.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mf">1E4</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">p</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
	<span class="nf">return </span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">exp</span><span class="p">(</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.1</span><span class="p">)</span>

<span class="c1"># Define function to normalise the PDF
</span><span class="k">def</span> <span class="nf">normalisation</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
	<span class="k">return</span> <span class="nf">simps</span><span class="p">(</span><span class="nf">p</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="p">)</span>

<span class="c1"># Define the distribution using rv_continuous
</span><span class="k">class</span> <span class="nc">blackbody</span><span class="p">(</span><span class="n">ss</span><span class="p">.</span><span class="n">rv_continuous</span><span class="p">):</span> 
    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">const</span><span class="p">):</span>
        <span class="nf">return </span><span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="n">const</span><span class="p">)</span> <span class="o">*</span> <span class="nf">p</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></code></pre></figure>

<p align="justify">We are now ready to use our above written functions to find $\mathcal{P}\left(x\right)$, $\Phi\left(x\right)$ and generate samples from the underlying distribution. We first need to instantiate it with the lower and upper limits given by <code>a</code> and <code>b</code> respectively. In principle, if not defined, it will be considered to be from $-\infty$ to $+\infty$.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">blackbody_distribution</span> <span class="o">=</span> <span class="nf">blackbody</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="sh">"</span><span class="s">blackbody_distribution</span><span class="sh">"</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>

<span class="c1"># Find the normalisation constant first
</span><span class="n">norm_constant</span> <span class="o">=</span> <span class="nf">normalisation</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="c1"># create pdf, cdf, random samples
</span><span class="n">pdf</span> <span class="o">=</span> <span class="n">blackbody_distribution</span><span class="p">.</span><span class="nf">pdf</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">const</span> <span class="o">=</span> <span class="n">norm_constant</span><span class="p">)</span>
<span class="n">cdf</span> <span class="o">=</span> <span class="n">blackbody_distribution</span><span class="p">.</span><span class="nf">cdf</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">const</span> <span class="o">=</span> <span class="n">norm_constant</span><span class="p">)</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">blackbody_distribution</span><span class="p">.</span><span class="nf">rvs</span><span class="p">(</span><span class="n">const</span> <span class="o">=</span> <span class="n">norm_constant</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mf">1E4</span><span class="p">)</span></code></pre></figure>

<dl class="wp-caption aligncenter" style="max-width: 700px">

<dt><a href=""><img class="" src="/images/scipy_continuous.jpg" alt="Samples generated using &lt;code&gt;rv_continuous&lt;/code&gt; from &lt;code&gt;scipy.stats&lt;/code&gt;" /></a></dt>

<dd>Samples generated using <code>rv_continuous</code> from <code>scipy.stats</code></dd>
</dl>

<p align="justify">The above plot shows the PDF, CDF and the samples generated from the distribution. In particular, we choose to draw 10 000 random samples. <code>rv_continuous</code> becomes useful when one needs more than just the samples. Once we have defined it, we can simply find other properties such as its mean, standard deviation and several more (see the <a href="https://docs.scipy.org/doc/scipy-0.16.0/reference/generated/scipy.stats.rv_continuous.html">documentation</a> for further details).</p>

<h2>Acceptance-Rejection Sampling</h2>

<dl class="wp-caption alignright" style="max-width: 265px">

<dt><a href=""><img class="" src="/images/circle_accept_reject.jpg" alt="Estimating value of $\pi$ using Monte Carlo Method" /></a></dt>

<dd>Estimating value of $\pi$ using Monte Carlo Method</dd>
</dl>

<p align="justify">Imagine we have a square board of size $l$, on which there is a circle of radius $0.5l$ at the centre of the board, that is, at $\left(0.5l,0.5l\right)$ in a Cartesian coordinate system. We are throwing darts randomly on the board, say $N$ times. If $n$ is the number of times that the darts lie within the circle, the probability of throwing the darts successfully into the circle is simply $\frac{n}{N}$. This is also roughly equal to the ratio of the area of the circle to the area of the square board. One could use this idea to have a rough estimate of the value of $\pi$, that is,</p>
<p>\begin{align}
\pi \approx 4 \times \frac{n}{N}
\end{align}</p>

<p align="justify">As $N$ becomes larger, one would have a more accurate estimate of the number $\pi$. This is the idea behind Monte Carlo sampling. Through this lens, an alternative way to sample from a normalised distribution is to use acceptance-rejection sampling scheme. It is also sometimes referred to as Lahiri's Sampling method. This method is advantageous in the sense that we do not need to know the CDF. However, one downfall is that samples may get rejected very often. Moreover, say we want $N$ random numbers, it is unlikely that we will get that number of samples relatively easily. In this post, we have not implemented this method. In short,</p>

<p align="justify" style="padding: 0px 100px 0px 100px"> suppose $X$ is a scalar random variable taking values in the interval $\left[a, b\right]$ according to the continuous probability density function $f\left(x\right)$. Let $M$ be an upper bound for $f$ on $\left[a, b\right]$, $M$ assumed finite. Choose $x$ uniformly in $\left[a, b\right]$. Then choose $u$ uniformly in $\left[0, M\right]$. If $u\leq f\left(x\right)$, we select $x$. Otherwise we reject $x$ and start over.</p>

<h2>Interpolation Method</h2>
<p align="justify">What do we do if neither of the two methods work but we do have the PDF? The procedures we adopt here is as follows:</p>

<ol type="1">
  <li>Find the CDF using <code>np.cumsum</code></li>
  <li>Generate a random number from a uniform distribution, $\mathcal{U}\left[0,1\right]$ </li>
  <li>Use <code>interp1d</code> from <code>scipy.interpolate</code> to estimate the random number.</li>
</ol>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c1"># Our Own pdf, cdf and samples
</span><span class="n">own_pdf</span> <span class="o">=</span> <span class="nf">p</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">norm_constant</span>
<span class="n">own_cdf</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">cumsum</span><span class="p">(</span><span class="n">own_pdf</span><span class="p">);</span> <span class="n">own_cdf</span> <span class="o">/=</span> <span class="nf">max</span><span class="p">(</span><span class="n">own_cdf</span><span class="p">)</span>

<span class="c1"># Define a function to return N samples
</span><span class="k">def</span> <span class="nf">genSamples</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
	<span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nf">int</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>
	<span class="n">func_interp</span> <span class="o">=</span> <span class="nf">interp1d</span><span class="p">(</span><span class="n">own_cdf</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
	<span class="n">samples</span> <span class="o">=</span> <span class="nf">func_interp</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
	<span class="k">return</span> <span class="n">samples</span>

<span class="n">own_samples</span> <span class="o">=</span> <span class="nf">genSamples</span><span class="p">(</span><span class="mf">1E4</span><span class="p">)</span></code></pre></figure>

<dl class="wp-caption aligncenter" style="max-width: 700px">

<dt><a href=""><img class="" src="/images/own_cdf_pdf_samples.jpg" alt="Samples generated using the CDF and interpolation method" /></a></dt>

<dd>Samples generated using the CDF and interpolation method</dd>
</dl>

<p align="justify">Here we have a nice distribution with 10 000 random samples drawn using the CDF. It looks similar to the one using <code>rv_continuous</code>!</p>

  </article>

  <!-- mathjax -->
  
  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    TeX: {
      equationNumbers: {
        autoNumber: "AMS"
      }
    },
    tex2jax: {
      inlineMath: [ ['$','$'] ],
      displayMath: [ ['$$','$$'] ],
      processEscapes: true,
    }
  });

  </script>
  <script type="text/javascript"
        src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
  

  <!-- Table -->
<style>
table, td, th {
    border: 1px solid black;
}

table {
    border-collapse: collapse;
}

</style>

<style type="text/css">
        table.tableizer-table {
                font-size: 13px;
                border: 1px solid #CCC; 
                font-family: Arial, Helvetica, sans-serif;
                margin-right: 10px;
                margin-bottom: 10px;
        } 
        .tableizer-table td {
                padding: 6px;
                margin: 3px;
                border: 1px solid #CCC;
        }
        .tableizer-table th {
                background-color: #104E8B;
                padding: 6px; 
                color: #FFF;
                font-weight: bold;
        }
</style>

</div>


      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

<!--     <h2 class="footer-heading">Arrykrishna Mootoovaloo</h2> -->

    <div class="footer-col-wrapper">
      <div class="footer-col  footer-col-1">
        <ul class="contact-list">
          <li><strong>Arrykrishna Mootoovaloo</strong></li>

          <li><a href="mailto:arrykrish@gmail.com">arrykrish@gmail.com</a></li>
        </ul>
      </div>

      <div class="footer-col  footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/Harry45">
              <span class="icon  icon--github">
                <svg viewBox="0 0 16 16">
                  <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
                </svg>
              </span>

              <span class="username">Harry45</span>
            </a>
          </li>
          

          
          <li>
            <a href="https://twitter.com/arrykrishna">
              <span class="icon  icon--twitter">
                <svg viewBox="0 0 16 16">
                  <path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809
                  c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/>
                </svg>
              </span>

              <span class="username">arrykrishna</span>
            </a>
          </li>
          


          
          <li>
            <a href="https://facebook.com/Arrykrishna">
              <span class="icon  icon--facebook">
                <svg viewBox="0 0 90 90">
                  <path fill="#828282" d="M90,15.001C90,7.119,82.884,0,75,0H15C7.116,0,0,7.119,0,15.001v59.998
    C0,82.881,7.116,90,15.001,90H45V56H34V41h11v-5.844C45,25.077,52.568,16,61.875,16H74v15H61.875C60.548,31,59,32.611,59,35.024V41
    h15v15H59v34h16c7.884,0,15-7.119,15-15.001V15.001z"/>
                </svg>
              </span>

              <span class="username">Arrykrishna</span>
            </a>
          </li>
          

          
          <li>
            <a href="https://linkedin.com/in/arrykrishna">
              <span class="icon  icon--linkedin">
                <svg viewBox="0 0 506 506">
                  <path fill="#828282" d="M398.355,0H31.782C14.229,0,0.002,13.793,0.002,30.817v368.471
    c0,17.025,14.232,30.83,31.78,30.83h366.573c17.549,0,31.76-13.814,31.76-30.83V30.817C430.115,13.798,415.904,0,398.355,0z
     M130.4,360.038H65.413V165.845H130.4V360.038z M97.913,139.315h-0.437c-21.793,0-35.92-14.904-35.92-33.563
    c0-19.035,14.542-33.535,36.767-33.535c22.227,0,35.899,14.496,36.331,33.535C134.654,124.415,120.555,139.315,97.913,139.315z
     M364.659,360.038h-64.966V256.138c0-26.107-9.413-43.921-32.907-43.921c-17.973,0-28.642,12.018-33.327,23.621
    c-1.736,4.144-2.166,9.94-2.166,15.728v108.468h-64.954c0,0,0.85-175.979,0-194.192h64.964v27.531
    c8.624-13.229,24.035-32.1,58.534-32.1c42.76,0,74.822,27.739,74.822,87.414V360.038z M230.883,193.99
    c0.111-0.182,0.266-0.401,0.42-0.614v0.614H230.883z"/>
                </svg>
              </span>

              <span class="username">arrykrishna</span>
            </a>
          </li>
          




        </ul>
      </div>

      <div class="footer-col  footer-col-3">
         <p class="text">
19, Miserden Crescent, Milton Keynes (MK4 4GJ) 
      </div>
    </div>

  </div>

</footer>




  </body>

</html>
